# aaPanel Manual Deployment Guide

This guide will help you deploy your Next.js portfolio website on aaPanel manually.

## Prerequisites

1. A server with aaPanel installed
2. Node.js 18+ installed on the server
3. MySQL/MariaDB database (for Prisma)
4. Your project files uploaded to the server

## Deployment Steps

### 1. Upload Project Files

Upload your project files to a directory on your server, for example:
```
/home/user/domains/yourdomain.com/public_html/
```

### 2. Install Dependencies

SSH into your server and navigate to your project directory:

```bash
cd /home/user/domains/yourdomain.com/public_html/
npm install --legacy-peer-deps
```

### 3. Set Up Database

1. In aaPanel, create a new MySQL/MariaDB database
2. Update your `.env` file with the database connection string:
```
DATABASE_URL="mysql://username:password@localhost:3306/database_name"
```

### 4. Build the Application

```bash
npm run build
```

### 5. Configure Node.js App in aaPanel

1. Go to aaPanel Dashboard
2. Navigate to "Website" → "Node.js project"
3. Add a new Node.js project with these settings:
   - **Project directory**: /home/user/domains/yourdomain.com/public_html/
   - **Startup file**: server.js (created by Next.js build)
   - **Node version**: 18.x or higher
   - **Port**: 3000 (or any available port)

### 6. Configure Environment Variables

In the Node.js project settings, add environment variables:
- `NODE_ENV=production`
- `PORT=3000`
- `DATABASE_URL=your_database_connection_string`

### 7. Set Up Reverse Proxy (Optional)

If you want to run the app behind Nginx:

1. In aaPanel, go to "Website" → "Your domain"
2. Add reverse proxy configuration:
   - **Proxy Name**: Next.js App
   - **Target URL**: http://127.0.0.1:3000
   - **Send domain**: $host

### 8. Start the Application

Start your Node.js application from the aaPanel interface or via command line:

```bash
npm start
```

## Configuration Details

### Next.js Configuration

The `next.config.mjs` is configured with:
- `output: 'standalone'` for self-contained deployment
- `images: { unoptimized: true }` for static image handling
- Production optimizations enabled

### Database Setup

The app uses Prisma with MySQL/MariaDB. Make sure to:
1. Run database migrations if needed: `npx prisma migrate deploy`
2. Generate Prisma client: `npx prisma generate`

## File Structure After Build

```
project/
├── .next/
│   ├── standalone/
│   └── static/
├── public/
├── node_modules/
├── package.json
├── server.js (generated by build)
└── .env
```

## Troubleshooting

### Build Errors

If you encounter build errors:
1. Check that Node.js version is 18+
2. Ensure all dependencies are installed
3. Verify database connection in `.env`

### Runtime Errors

If the app doesn't run properly:
1. Check environment variables are set correctly
2. Verify database is accessible
3. Check aaPanel application logs

### Port Issues

If port 3000 is occupied:
1. Use a different port (e.g., 3001, 8000)
2. Update the PORT environment variable
3. Update reverse proxy configuration if using Nginx

## Maintenance

### Updating Your App

1. Upload new files to your project directory
2. Run `npm install --legacy-peer-deps`
3. Run `npm run build`
4. Restart the Node.js application in aaPanel

### Database Backups

Set up regular database backups through aaPanel's database management interface.

### SSL Certificate

Enable SSL through aaPanel's SSL management for your domain.

## Support

For aaPanel-specific issues:
- [aaPanel Documentation](https://www.aapanel.com/docs)

For Next.js deployment issues:
- [Next.js Deployment Documentation](https://nextjs.org/docs/deployment)